# PVT (Prolonged Venous Transit) ê³„ì‚° ê¸°ëŠ¥

## ğŸ“‹ ê°œìš”

NeuroFlowì— **PVT (Prolonged Venous Transit)** ê³„ì‚° ê¸°ëŠ¥ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.

PVTëŠ” ê¸‰ì„± í—ˆí˜ˆì„± ë‡Œì¡¸ì¤‘ í™˜ìì˜ **ì •ë§¥ ìœ ì¶œ ì§€ì—°**ì„ í‰ê°€í•˜ëŠ” ë°”ì´ì˜¤ë§ˆì»¤ë¡œ, ì˜ˆí›„ ì˜ˆì¸¡ì— ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤.

---

## ğŸ”¬ ë°©ë²•ë¡ 

### í•™ìˆ  ê·¼ê±°

**Amorim et al. (2023)**ì˜ ì—°êµ¬ ë°©ë²•ë¡ ì„ ê¸°ë°˜ìœ¼ë¡œ êµ¬í˜„:

```
Amorim, G., Yedavalli, N., Musmar, M., Dehkharghani, T. F., Liebeskind, M. G., 
Christensen, S., Albers, G. W., Faizy, J., & Heit, J. J. (2023). 
CT perfusion to measure venous outflow in acute ischemic stroke in patients 
with a large vessel occlusion. 
Journal of NeuroInterventional Surgery, 16(4), 343-348. 
https://doi.org/10.1136/jnis-2023-020613
```

### ê³„ì‚° ë°©ë²•

```
PVT+ = (SSS Tmax â‰¥ 10s) OR (Torcula Tmax â‰¥ 10s)
```

**ì¸¡ì • ìœ„ì¹˜**:
1. **SSS (Superior Sagittal Sinus)**: ìƒì‹œìƒì •ë§¥ë™ (í‘œì¬ì„± ì •ë§¥ ë°°ì¶œ)
   - ìœ„ì¹˜: ì¸¡ë‡Œì‹¤ í›„ê°(occipital horns) ë ˆë²¨
   
2. **Torcula (Confluence of Sinuses)**: ì •ë§¥ë™ í•©ë¥˜ë¶€ (ì‹¬ë¶€ ì •ë§¥ ë°°ì¶œ)
   - ìœ„ì¹˜: ë‡Œì˜ í›„ë°© ì¤‘ì•™ë¶€

**íŒì • ê¸°ì¤€**:
- **Tmax â‰¥ 10ì´ˆ**: PVT+ (ì •ë§¥ ìœ ì¶œ ì§€ì—°)
- **Tmax < 10ì´ˆ**: PVT- (ì •ìƒ ì •ë§¥ ìœ ì¶œ)

---

## ğŸ“Š ì„ìƒì  ì˜ì˜

### ì˜ˆí›„ ì˜ˆì¸¡ë ¥

| PVT ìƒíƒœ | Excellent Recovery (mRS 0-1) | 90ì¼ Median mRS |
|---------|------------------------------|-----------------|
| PVT+    | 11%                          | 4 (ì¤‘ì¦ ì¥ì• )    |
| PVT-    | 39%                          | 2 (ê²½ì¦ ì¥ì• )    |

**Adjusted OR**: 0.11 (95% CI: 0.02-0.48, p=0.006)

### PVT+ í™˜ìì˜ íŠ¹ì§•

- âœ… ë” ë†’ì€ NIHSS ì ìˆ˜ (16 vs 14)
- âœ… ë” í° mismatch volume (118mL vs 81mL)
- âœ… ë” ê¸´ ì‹œìˆ  ì‹œê°„ (35ë¶„ vs 25ë¶„)
- âš ï¸ ë” ë‚˜ìœ 90ì¼ ì˜ˆí›„

---

## ğŸ¯ NeuroFlow í†µí•©

### ìë™ ê³„ì‚°

ë¶„ì„ ì›Œí¬í”Œë¡œìš°ì— ìë™ìœ¼ë¡œ í†µí•©:

```
1. DICOM ë¶„ì„
2. Tmax map ìƒì„±
3. PVT ìë™ ê³„ì‚° â† NEW!
4. ì›¹ ë·°ì–´ ìƒì„±
5. ê²°ê³¼ í‘œì‹œ
```

### ê²°ê³¼ í‘œì‹œ

**Metrics í…Œì´ë¸”ì— 3ê°œ í•­ëª© ì¶”ê°€**:

1. **PVT Status**: PVT+ ë˜ëŠ” PVT-
   - ğŸ”´ PVT+: ë¹¨ê°„ìƒ‰ ë°°ê²½ (ìœ„í—˜)
   - ğŸŸ¢ PVT-: ì´ˆë¡ìƒ‰ ë°°ê²½ (ì •ìƒ)

2. **SSS Tmax**: ìƒì‹œìƒì •ë§¥ë™ Tmax ê°’ (ì´ˆ)

3. **Torcula Tmax**: ì •ë§¥ë™ í•©ë¥˜ë¶€ Tmax ê°’ (ì´ˆ)

---

## ğŸ’» ì‚¬ìš© ë°©ë²•

### GUIì—ì„œ ì‚¬ìš©

1. **Select Folder** - DICOM í´ë” ì„ íƒ
2. **Start Analysis** - ë¶„ì„ ì‹œì‘
3. ìë™ìœ¼ë¡œ PVT ê³„ì‚°ë¨
4. ê²°ê³¼ í…Œì´ë¸”ì—ì„œ PVT ìƒíƒœ í™•ì¸

### ëª…ë ¹ì¤„ì—ì„œ ë‹¨ë… ì‹¤í–‰

```bash
# Tmax NIfTI íŒŒì¼ì´ ìˆëŠ” ê²½ìš°
python scripts/calculate_pvt_tmax.py analysis_results/Tmax.nii.gz pvt_result.json

# ê²°ê³¼ í™•ì¸
cat pvt_result.json
```

---

## ğŸ“ ì¶œë ¥ íŒŒì¼

### `pvt_result.json`

```json
{
  "pvt_status": "PVT-",
  "pvt_positive": false,
  "sss_tmax_mean": 8.45,
  "sss_tmax_max": 9.12,
  "sss_positive": false,
  "torcula_tmax_mean": 7.89,
  "torcula_tmax_max": 8.67,
  "torcula_positive": false,
  "threshold": 10.0,
  "interpretation": "ì •ìƒ ì •ë§¥ ìœ ì¶œ (Normal venous outflow)",
  "clinical_significance": {
    "risk_level": "LOW",
    "prognosis": "ì–‘í˜¸í•œ ì˜ˆí›„ ì˜ˆìƒ (Favorable prognosis)",
    "recommendation": "í‘œì¤€ ì¹˜ë£Œ í”„ë¡œí† ì½œ ì ìš©",
    "evidence": "PVT- í™˜ìëŠ” excellent recovery í™•ë¥  39%"
  }
}
```

---

## ğŸ”§ ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

### ROI ì •ì˜

**SSS (Superior Sagittal Sinus)**:
```python
# ë‡Œì˜ ìƒë¶€ ì •ì¤‘ì„ 
z_start = int(depth * 0.75)  # ìƒìœ„ 25%
y_center = width // 2
y_range = Â±8 pixels
```

**Torcula (Confluence of Sinuses)**:
```python
# ë‡Œì˜ í›„ë°© ì¤‘ì•™ë¶€
x_posterior = int(height * 0.75)  # í›„ë°© 25%
y_center = width // 2
z_mid = int(depth * 0.6)
roi_size = 12 pixels (êµ¬í˜•)
```

### í•„í„°ë§

- Tmax > 6ì´ˆì¸ ì˜ì—­ë§Œ ê³ ë ¤ (ì •ë§¥ ì˜ì—­)
- Brain maskì™€ êµì§‘í•©

---

## âš ï¸ ì œí•œì‚¬í•­ ë° í–¥í›„ ê°œì„ 

### í˜„ì¬ ì œí•œì‚¬í•­

1. **ROI ìë™ ì„ íƒ**: íœ´ë¦¬ìŠ¤í‹± ê¸°ë°˜ (í•´ë¶€í•™ì  ìœ„ì¹˜ ì¶”ì •)
2. **í•œêµ­ì¸ ë°ì´í„° ê²€ì¦ í•„ìš”**: ë…¼ë¬¸ì€ ì„œì–‘ì¸ ë°ì´í„° ê¸°ë°˜
3. **Threshold ê³ ì •**: 10ì´ˆ (ì¡°ì • ê°€ëŠ¥ì„± ê²€í†  í•„ìš”)

### í–¥í›„ ê°œì„  ê³„íš

1. **Atlas ê¸°ë°˜ ROI**: í•´ë¶€í•™ì  atlasë¡œ ì •í™•í•œ SSS/Torcula ìœ„ì¹˜ íŒŒì•…
2. **Deep Learning**: ìë™ ì •ë§¥ë™ segmentation
3. **í•œêµ­ì¸ ë°ì´í„° ê²€ì¦**: ìµœì  threshold ì¬ê²€ì¦
4. **ì‹œê°í™”**: SSS/Torcula ROI í‘œì‹œ

---

## ğŸ“š ì¶”ê°€ ì°¸ê³  ë¬¸í—Œ

### ì˜¤í”ˆ ì•¡ì„¸ìŠ¤ ë…¼ë¬¸

1. **van der Schaaf et al. (2006)** - AIF/VOF ì¸¡ì • ë°©ë²•ë¡ 
   - https://www.ajnr.org/content/27/1/46
   - Gamma variate fitting, partial volume correction

2. **PMC Article** - Partial Volume Effects
   - https://pmc.ncbi.nlm.nih.gov/articles/PMC7976058/

---

## ğŸ†˜ ë¬¸ì œ í•´ê²°

### PVT ê³„ì‚° ì‹¤íŒ¨

**ì¦ìƒ**: "âš ï¸ PVT calculation failed"

**ì›ì¸**:
1. Tmax.nii.gz íŒŒì¼ì´ ì—†ìŒ
2. NIfTI íŒŒì¼ í˜•ì‹ ì˜¤ë¥˜
3. ë©”ëª¨ë¦¬ ë¶€ì¡±

**í•´ê²°**:
```bash
# Tmax íŒŒì¼ í™•ì¸
ls -lh analysis_results/Tmax.nii.gz

# ìˆ˜ë™ ì‹¤í–‰ìœ¼ë¡œ ì˜¤ë¥˜ í™•ì¸
python scripts/calculate_pvt_tmax.py analysis_results/Tmax.nii.gz
```

### ROIê°€ ë¹„ì–´ìˆìŒ

**ì¦ìƒ**: SSS/Torcula Tmax = 0.00

**ì›ì¸**: ROI ìœ„ì¹˜ ì¶”ì • ì‹¤íŒ¨

**í•´ê²°**: 
- ë‹¤ë¥¸ í™˜ì ë°ì´í„°ë¡œ í…ŒìŠ¤íŠ¸
- ROI íŒŒë¼ë¯¸í„° ì¡°ì • (scripts/calculate_pvt_tmax.py)

---

## ğŸ“ ë¬¸ì˜

PVT ê³„ì‚° ê´€ë ¨ ë¬¸ì˜ì‚¬í•­ì€ ì‹ ê²½ì™¸ê³¼ ì „ë¬¸ì˜ì™€ ìƒì˜í•˜ì—¬ ê°œì„ í•˜ê² ìŠµë‹ˆë‹¤.

**For Research Use Only - Not for Clinical Diagnosis**
